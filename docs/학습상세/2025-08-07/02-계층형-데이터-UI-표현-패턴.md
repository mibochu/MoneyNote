# 계층형 데이터 UI 표현 패턴

## 🎯 학습 목표
대분류-소분류 관계의 트리 구조 데이터를 직관적이고 인터랙티브한 UI로 표현하는 방법을 학습한다.

## 💡 왜 이걸 배웠는가?
카테고리 관리에서 대분류와 소분류의 계층 관계를 사용자가 한눈에 파악할 수 있도록 해야 했다. 단순한 목록으로는 관계를 표현하기 어려웠고, 확장/축소 기능으로 필요한 정보만 볼 수 있게 해야 했다.

## 🏗️ 구현한 UI 패턴

### 1. 확장/축소 가능한 트리 구조
```typescript
const [expandedCategories, setExpandedCategories] = useState<string[]>(
  showAll ? categories.map(cat => cat.id) : []
);

const handleToggleExpand = (categoryId: string) => {
  setExpandedCategories(prev =>
    prev.includes(categoryId)
      ? prev.filter(id => id !== categoryId)  // 축소
      : [...prev, categoryId]                 // 확장
  );
};
```

### 2. 시각적 계층 구조 표현
```jsx
{/* 대분류 헤더 */}
<Box
  sx={{
    p: 2,
    cursor: 'pointer',
    backgroundColor: alpha(category.color, 0.05),  // 연한 배경색
    borderBottom: isExpanded ? `1px solid ${alpha(category.color, 0.1)}` : 'none'
  }}
>
  {/* 대분류 내용 */}
</Box>

{/* 소분류 목록 */}
<Collapse in={isExpanded}>
  <Box sx={{ backgroundColor: alpha(category.color, 0.02) }}>
    {category.subcategories.map((subcategory) => (
      <Box
        key={subcategory.id}
        sx={{
          p: 2,
          pl: 6,  // 왼쪽 여백으로 계층 표현
          // ...
        }}
      >
        {/* 소분류 내용 */}
      </Box>
    ))}
  </Box>
</Collapse>
```

### 3. 색상을 통한 관계 표현
```typescript
// 대분류 색상
<Box
  sx={{
    backgroundColor: category.color,  // 진한 색상
    // ...
  }}
>
  {category.icon}
</Box>

// 소분류 색상 (상속 또는 독립)
<Box
  sx={{
    backgroundColor: subcategory.color || category.color,  // 부모 색상 상속
    // ...
  }}
>
  {subcategory.icon}
</Box>
```

## 🔧 핵심 구현 기법

### 1. Collapse 컴포넌트 활용
Material-UI의 Collapse로 부드러운 확장/축소 애니메이션:

```jsx
<Collapse 
  in={isExpanded}
  timeout="auto"
  unmountOnExit  // 성능 최적화: 축소 시 DOM에서 제거
>
  <Box sx={{ backgroundColor: alpha(category.color, 0.02) }}>
    {/* 소분류 목록 */}
  </Box>
</Collapse>
```

### 2. 들여쓰기를 통한 계층 표현
```typescript
// 대분류: 기본 padding
sx={{ p: 2 }}

// 소분류: 왼쪽 여백 추가
sx={{ p: 2, pl: 6 }}  // pl: 6 = 48px 들여쓰기

// 만약 3단계가 있다면
sx={{ p: 2, pl: 10 }} // 더 깊은 들여쓰기
```

### 3. 동적 아이콘과 상태 표시
```jsx
<IconButton onClick={() => handleToggleExpand(category.id)}>
  {isExpanded ? <ExpandLessIcon /> : <ExpandMoreIcon />}
</IconButton>

// 드래그 핸들 (향후 순서 변경용)
<DragIndicatorIcon 
  sx={{ 
    color: 'text.disabled',
    cursor: 'grab'
  }} 
/>

// 기본 카테고리 표시
{category.isDefault && (
  <Tooltip title="기본 카테고리">
    <LockIcon sx={{ fontSize: 16, color: 'text.disabled' }} />
  </Tooltip>
)}
```

## 🎨 시각적 설계 원칙

### 1. 색상 계층 시스템
```typescript
// 대분류 배경: 진한 색상 (5% 투명도)
backgroundColor: alpha(category.color, 0.05)

// 소분류 배경: 더 연한 색상 (2% 투명도)  
backgroundColor: alpha(category.color, 0.02)

// 호버 효과: 중간 강도 (10% 투명도)
'&:hover': {
  backgroundColor: alpha(category.color, 0.1)
}
```

### 2. 간격과 여백 체계
```typescript
// 대분류 간격
<Stack spacing={2}>

// 대분류 내부 요소 간격  
<Stack direction="row" alignItems="center" spacing={2}>

// 소분류 들여쓰기
sx={{ pl: 6 }}  // 48px = 24px(아이콘) + 16px(간격) + 8px(여백)
```

### 3. 상호작용 피드백
```typescript
// 클릭 가능한 영역 표시
cursor: 'pointer'

// 호버 시 그림자 효과
'&:hover': {
  boxShadow: 2
}

// 활성 상태 표시 (확장된 경우)
borderBottom: isExpanded ? `1px solid ${alpha(category.color, 0.1)}` : 'none'
```

## 🚀 고급 기능 구현

### 1. 컨텍스트 메뉴 통합
```typescript
const handleMenuOpen = (
  event: React.MouseEvent<HTMLElement>,
  type: 'category' | 'subcategory',
  item: Category | Subcategory,
  categoryId?: string
) => {
  event.stopPropagation(); // 확장/축소 이벤트와 분리
  setAnchorEl(event.currentTarget);
  setSelectedItem({ type, item, categoryId });
};
```

### 2. 조건부 렌더링 최적화
```jsx
{category.subcategories.length > 0 ? (
  // 소분류가 있는 경우: 목록 렌더링
  <Stack>
    {category.subcategories.map((subcategory) => (
      // 소분류 항목들
    ))}
  </Stack>
) : (
  // 소분류가 없는 경우: 안내 메시지
  <Box sx={{ p: 3, textAlign: 'center' }}>
    <Typography variant="body2" color="text.secondary">
      소분류가 없습니다
    </Typography>
  </Box>
)}
```

### 3. 빈 상태 처리
```jsx
if (categories.length === 0) {
  return (
    <Paper sx={{ p: 4, textAlign: 'center' }}>
      <Typography variant="h6" color="text.secondary" gutterBottom>
        카테고리가 없습니다
      </Typography>
      <Typography variant="body2" color="text.secondary">
        새 대분류를 추가하여 시작하세요
      </Typography>
    </Paper>
  );
}
```

## 📱 반응형 고려사항

### 1. 모바일에서의 터치 영역
```typescript
// 최소 44px 터치 영역 확보
sx={{
  minHeight: 44,
  p: 2,
  // ...
}}
```

### 2. 작은 화면에서 정보 밀도 조정
```typescript
// 데스크톱: 풍부한 정보 표시
<Stack direction="row" alignItems="center" spacing={2}>
  <CategoryIcon />
  <CategoryName />
  <SubcategoryCount />
  <ActionButtons />
</Stack>

// 모바일: 핵심 정보만 표시
<Stack spacing={1}>
  <Stack direction="row" alignItems="center" spacing={1}>
    <CategoryIcon />
    <CategoryName />
  </Stack>
  {isMobile && <SubcategoryCount />}
</Stack>
```

## 💡 핵심 깨달음

### 1. 시각적 계층의 중요성
단순한 들여쓰기와 색상 변화만으로도 복잡한 관계를 직관적으로 표현할 수 있었다.

### 2. 애니메이션의 사용자 경험 개선 효과
Collapse의 부드러운 전환이 정보의 출현/사라짐을 자연스럽게 만들어 사용자 혼란을 줄였다.

### 3. 상태 관리의 단순화
확장 상태를 문자열 배열로 관리하는 것이 복잡한 객체보다 훨씬 간단하고 효율적이었다.

## 🔄 다음 응용 분야
- 파일 탐색기 인터페이스
- 조직도 표시
- 댓글 대댓글 구조  
- 메뉴 네비게이션 구조